!function(){var a={NODE:!1,ENDER:!1,either:function(b,c){return a.NODE||!c?b:c},run:function(b,c){return a.either(b,c)()}};typeof module!="undefined"&&typeof require!="undefined"?a.NODE=!0:typeof require!="undefined"&&typeof provide!="undefined"&&(a.ENDER=!0),a.run(function(){module.exports=a},function(){provide("std::env",a)})}(),!function(){var a=require("underscore");a.mixin({args:function(a,b,c){return b||(b=0),c||(c=a.length),Array.prototype.slice.call(a,b,c)},log:function(a){return typeof console!="undefined"&&console.log&&console.log(a),a},inherit:function(){var b=function(){};return function(c,d){return b.prototype=c.prototype,d.prototype=new b,d.prototype.constructor=d,a.extend(d,c),d}}(),nextTick:function(a){typeof process!="undefined"&&process.nextTick?process.nextTick(a):typeof window!="undefined"&&window.setImmediate?window.setImmediate(a):setTimeout(a,0)},combine:function(){var b=a.chain(arguments).args().flatten().value();return function(){var c=a.args(arguments),d=0,e=b.length;for(d,e;d<e;d++)b[d].apply(null,c)}},callback:function(){var b=a.chain(arguments).args().flatten().hashify().value().optional("ctx",null,{type:"object"}).required("callback").many("rest").end;b.callback&&b.callback.apply(b.ctx,b.rest)},hashify:function(){var b=function(b,c,d){var e,f=!1;return a.has(c,b)?(e=c[b],typeof e=="object"&&a.has(e,"not")&&(e=e[b],f=!0),f!==d(e)):!0},c=function(a,c,d,e){var f=!0,g="length",h=">"+g,i=">="+g,j="<"+g,k="<="+g;return typeof e=="function"?e(a,c,d):typeof e=="boolean"?e:(f=b("type",e,function(b){return typeof a===b}),f=f&&b("instance",e,function(b){return a instanceof b}),f=f&&b(g,e,function(a){return d.length===a}),f=f&&b(h,e,function(a){return d.length>a}),f=f&&b(i,e,function(a){return d.length>=a}),f=f&&b(j,e,function(a){return d.length<a}),f=f&&b(k,e,function(a){return d.length<=a}),f)};return function(b){var d=0;return a.isArray(b)||(b=a.args(b)),{end:{},required:function(a){return this.end[a]=b[d],d++,this},optional:function(a,e,f){var g=b[d],h=e,i=c(g,d,b,f);return i&&(d++,h=g),this.end[a]=h,this},many:function(a,e){var f,g=[],h=!0;if(e)while(h&&d<b.length)f=b[d],h=c(f,d,b,e),h&&(d++,g.push(f));else g=b.slice(d);return this.end[a]=g,this}}}}()}),typeof provide!="undefined"?provide("std::utils",a):module.exports=a}(),!function(){var a=typeof provide=="undefined"?require("./env"):require("std::env"),b=require(a.either("./utils","std::utils")),c=function(){this._events={},this._maxListeners=10};c.prototype.listeners=function(a){return this._events[a]||(this._events[a]=[]),this._events[a]},c.prototype.setMaxListeners=function(a){this._maxListeners=a},c.prototype.on=c.prototype.addListener=function(a,c){this.emit("newListener",c);var d=this.listeners(a);return d.push(c),d.length>=this._maxListeners&&b.log("Warning: "+this+" has more than "+this._maxListeners+" attached to event "+a+"."),this},c.prototype.once=function(a,b){var c={listener:b};return this.listeners(a).push(c),this.emit("newListener",c),this},c.prototype.removeListener=function(a,b){var c,d=this.listeners(a);for(c=0;c<d.length;c++)if(d[c]===b){d.splice(c,1);break}return this},c.prototype.removeAllListeners=function(a){return this._events[a]=[],this},c.prototype.emit=function(){var a,c,d=arguments[0],e=b.args(arguments,1),f=this._events[d]||[],g=f.length!==0,h=[];for(a=0;a<f.length;a++)c=f[a],typeof c=="object"&&(h.push(a),c=c.listener),c.apply(this,e);for(a=0;a<h.length;a++)f.splice(h[a]-a,1);return g},a.run(function(){module.exports=c},function(){provide("std::emitter",c)})}(),!function(){var a=require(typeof provide=="undefined"?"./env":"std::env"),b=require(a.either("./utils","std::utils")),c=a.run(function(){return require("events").EventEmitter},function(){return require("std::emitter")}),d="done",e="cancel",f=function(a,b){var d,e,f,h,i,m=!1,n=!0,o=null;this._internal={emitter:new c,count:0,isDone:!1,isCancelled:!1,err:null,data:null,callback:b};for(d=0,e=a.length;d<e;d++){f=a[d],h=f._internal,m=m||h.isCancelled,o=h.err,i=h.isDone&&!m,n=n&&i;if(m)break;i||(this._internal.count++,f.done(k(this)),f.cancel(l(this)))}n&&g(this),m&&j(this,o)};f.prototype.isDone=function(){return this._internal.isDone},f.prototype.isCancelled=function(){return this._internal.isCancelled},f.prototype.error=function(){return this._internal.err},f.prototype.data=function(){return this._internal.data},f.prototype.done=function(a){var c=this._internal;return c.isCancelled||(a=b.bind(a,this),c.isDone?a(c.data):c.emitter.on(d,a)),this},f.prototype.cancel=function(a){var c=this._internal;return c.isDone||(a=b.bind(a,this),c.isCancelled?a(c.err):c.emitter.on(e,a)),this},f.prototype.removeDone=function(a){this._internal.emitter.removeListener(d,a)},f.prototype.removeCancelled=function(a){this._internal.emitter.removeListener(e,a)};var g=function(a){var b=a._internal;!b.isCancelled&&!b.isDone&&b.callback.call(a,m(a),n(a))},h=function(a){var b=a._internal;b.count--,b.count===0&&g(a)},i=function(a,b){var e=a._internal;if(e.isDone||e.isCancelled)return;e.isDone=!0,e.data=b,e.emitter.emit(d,b),e.emitter=new c},j=function(a,b){var d=a._internal;if(d.isDone||d.isCancelled)return;d.isCancelled=!0,d.err=b,d.emitter.emit(e,b),d.emitter=new c},k=function(a){return b.once(function(){h(a)})},l=function(a){return b.once(function(b){j(a,b)})},m=function(a){return b.once(function(b){i(a,b)})},n=function(a){return b.once(function(b){j(a,b)})},o=function(){var a=b.chain(arguments).args().flatten().hashify().value().many("dependencies",{instance:f}).required("callback").end;return new f(a.dependencies,a.callback)};a.run(function(){module.exports=o},function(){provide("std::wait",o)})}(),!function(){var a=require(typeof provide=="undefined"?"./env":"std::env"),b=require(a.either("./wait","std::wait")),c=function(){this._internal={promise:b(function(a){a()})}};c.prototype.enqueue=function(a){var c=this._internal,d=c.promise=b(c.promise,a);return d.cancel(function(){c.promise===this&&(c.promise=b(function(a){a()}))}),d},c.prototype.top=function(){return this._internal.promise},typeof provide=="undefined"?module.exports=c:provide("std::async-queue",c)}(),!function(){var a=require(typeof provide=="undefined"?"./env":"std::env"),b=a.run(function(){return require("events").EventEmitter},function(){return require("std::emitter")}),c=require(a.either("./utils","std::utils")),d=require(a.either("./wait","std::wait")),e="set:",f="destroy:",g="invalidate:",h="change:",i=c.inherit(b,function(){b.call(this),this._data={},this._loading={},j(this)});i.serialize=function(a,b){var d,e;this.serial=this.serial||{},e=this.serial[a]=this.serial[a]||{};for(d in b)c.has(b,d)&&(e[d]=b[d])},i.prototype.get=function(a,b){this._data.hasOwnProperty(a)?b(null,this._data[a]):this.load(a,b)},i.prototype.invalidate=function(a,b){var e=this;c.has(this._data,a)&&delete this._data[a];var f=d(function(c,d){e.load(a,function(a,e){a?d(a):c(e),b&&b(a,e)})});this.emit(g+a,f)},i.prototype.load=function(a,b){var d=this,e=this._data[a];if(this._loading[a]){this._loading[a].push(b);return}this._loading[a]=[],b&&this._loading[a].push(b),l(this,"get",a,function(b,f){b?c.each(d._loading[a],function(a){a.call(d,b)}):(d._data[a]=f,d.emit(h+a,e,f),c.each(d._loading[a],function(a){a.call(d,null,f)})),delete d._loading[a]})},i.prototype.set=function(a,b,d){var f=this._data[a];f!==b?(this._data[a]=b,this.emit(e+a,f,b),this.emit(h+a,f,b),l(this,"set",a,d)):c.callback(d,null,b)},i.prototype.destroy=function(a,b){this._data.hasOwnProperty(a)?(delete this._data[a],this.emit(f+a,value),l(this,"destroy",a,b)):c.callback(b,null)};var j=function(a){var b,d,e=a.constructor,f=e.serial;if(f)for(b in f)c.has(f,b)&&k(a,f[b],b)},k=function(a,b,d){c.has(b,"init")&&b.init.call(a,function(b,e){b?c.log(b):a._data[d]=e})},l=function(a,b,d,e){var f,g=a.constructor,h=g.serial;if(h&&c.has(h,d)){f=h[d];if(c.has(f,b)){c.nextTick(function(){f[b].call(a,e)});return}}c.nextTick(function(){c.callback(a,e,"No serializer!",null)})};a.run(function(){module.exports=i},function(){provide("std::cache",i)})}(),!function(){var a=require(typeof provide=="undefined"?"./env":"std::env"),b=a.run(function(){return require("events").EventEmitter},function(){return require("std::emitter")}),c=require(a.either("./utils","std::utils")),d=c.inherit(b,function(a,c){b.call(this),this.time=a||0,this._internal={on:!1,looping:c||!1}});d.prototype.start=function(){this._internal.on||(this._internal.on=!0,this._internal.countdown=0,this.emit("start"),e(this,this.time))},d.prototype.stop=function(){this._internal.on&&(this._internal.on=!1,this._internal.countdown=0,this.emit("stop"))};var e=function(a,b){var c=new Date;setTimeout(function(){var d=new Date-c,f=a._internal;f.on&&(a.emit("tick",d,b),f.looping?e(a,b):a.stop())},b)};a.run(function(){module.exports=d},function(){provide("std::alarm",d)})}(),!function(){function c(a){this._internal={a:new b(a,!0)},this._internal.a.start()}function d(a,b){var c=0;return function(d){c+=d,c>=b&&(c-=b,a())}}var a=require(typeof provide=="undefined"?"./env":"std::env"),b=a.run(function(){return require("./alarm")},function(){return require("std::alarm")});c.prototype.setInterval=function(a,b){var c=d(a,b);return this._internal.a.on("tick",c),c},c.prototype.clearInterval=function(a){this._internal.a.removeListener("tick",a)},c.prototype.setTimeout=function(a,b){var c=this,e=d(function(){c._internal.a.removeListener("tick",e),a()},b);return e._isTimeout=!0,this._internal.a.on("tick",e),e},c.prototype.clearTimeout=function(a){if(a)this._internal.a.removeListener("tick",a);else{var b,c,d,e=this._internal.a.listeners("tick"),f=[];for(b=0,c=e.length;b<c;b++)d=e[b],d._isTimeout&&f.push(d);for(b=0,c=f.length;b<c;b++)this._internal.a.removeListener("tick",f[b])}},c.prototype.start=function(){this._internal.a.start()},c.prototype.stop=function(){this._internal.a.stop()},a.run(function(){module.exports=c},function(){provide("std::timing",c)})}();